<Window x:Class="Client.MVVM.View.Windows.LocalUsersWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
  xmlns:c="clr-namespace:Client.MVVM.View.Converters"
  mc:Ignorable="d"
  Title="{Binding Converter={x:Static c:Strings.Instance}, ConverterParameter='Local users'}"
  Height="450" Width="800"
  Name="LocalUsersWindowName">
  <i:Interaction.Triggers>
    <i:EventTrigger EventName="Loaded">
      <i:InvokeCommandAction Command="{Binding WindowLoaded}"
        CommandParameter="{Binding ElementName=LocalUsersWindowName}"/>
    </i:EventTrigger>
  </i:Interaction.Triggers>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="*"/>
      <RowDefinition Height="auto"/>
    </Grid.RowDefinitions>
    <ScrollViewer Grid.Row="0">
      <!--https://stackoverflow.com/a/33765748/14357934-->
      <ItemsControl ItemsSource="{Binding LocalUsers}">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <Grid x:Name="ItemGrid">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>
              <i:Interaction.Triggers>
                <i:EventTrigger EventName="MouseLeftButtonDown">
                  <!--bindujemy obiekt LocalUser, a nie jego któreś pole, więc wystarczy samo "CommandParameter={Binding}"-->
                  <i:InvokeCommandAction Command="{Binding Path=DataContext.UserDoubleClick,
                    RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}"
                    CommandParameter="{Binding}"/>
                  <!--równoważne, bo okno ma nadaną nazwę (LocalUsersWindowName)
                  <i:InvokeCommandAction Command="{Binding Path=DataContext.UserDoubleClick,
                    ElementName=LocalUsersWindowName}" CommandParameter="{Binding}" />-->
                </i:EventTrigger>
              </i:Interaction.Triggers>
              <Grid.Style>
                <Style TargetType="Grid">
                  <Setter Property="Background" Value="Transparent"/>
                  <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                      <Setter Property="Background" Value="Red"/>
                    </Trigger>
                  </Style.Triggers>
                </Style>
              </Grid.Style>
              <TextBlock Grid.Column="0" Text="{Binding Name}"/>
              <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <StackPanel.Style>
                  <Style TargetType="StackPanel">
                    <Setter Property="Visibility" Value="Hidden"/>
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding ElementName=ItemGrid, Path=IsMouseOver}"
                        Value="True">
                        <Setter Property="Visibility" Value="Visible"/>
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </StackPanel.Style>
                <Button Grid.Column="1" Content="{Binding Converter={x:Static c:Strings.Instance},
                  ConverterParameter='Edit'}"/>
                <Button Grid.Column="1" Content="{Binding Converter={x:Static c:Strings.Instance},
                  ConverterParameter='Delete'}"/>
              </StackPanel>
            </Grid>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </ScrollViewer>
    <Button Grid.Row="1"
      Content="{Binding Converter={x:Static c:Strings.Instance}, ConverterParameter='Create'}"
      Command="{Binding Path=Create}"/>
  </Grid>
</Window>
